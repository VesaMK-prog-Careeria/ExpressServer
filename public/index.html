<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herkut</title>
</head>
<body>
    <center>
        <h1>Hello from node & express server!</h1>

        <div id="sisältö"></div>
    </center>


    <script>
        async function fetchData() {
        document.getElementById("sisältö").innerHTML = "<h4>Ladataan herkkuja...</h4>"

        var x = `<table><thead><th>Herkun nimi</th><th>tuotekoodi</th></thead><tbody>`

            try {
                const response = await fetch("http://localhost:3000/api/herkut") //haetaan herkut
                const herkkudata = await response.json() //muutetaan json javascriptiksi

                await herkkudata.map(h => { //loopataan läpi oliot map funktiolla, h on 1 herkku
                    x += `<tr><td>${h.name}</td><td>${h.id}</td></tr>`
                })

                // taulukko päätetään ja renderöidään html elementtiin
                x += `</tbody></table>`
                document.getElementById("sisältö").innerHTML = x

                //virheenkäsittely
            } catch (error) {
                console.error("Virhe herkkuja ladattaessa: ", error)
                //document.getElementById("sisältö").innerHTML = "<h4>Virhe herkkuja ladattaessa...</h4>"
            }
            }
        fetchData()
    </script>
</body>
</html>